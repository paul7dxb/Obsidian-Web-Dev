# Abbreviations

![[AWS_Load_Balancer_Types.png]]

- ELB
	- Elastic Load Balancing
- ALB
	- Application Load balancer 

- Vertical scaling
	- Increase instance size
	- Up or down
- Horizontal Scaling
	- Number of instances
	- Out or in
	- Auto scaling group
	- Load balancer
- High availability
	- Multi AZ
	- Auto scaling group multi AZ
	- Load balancer multi AZ

# Load Balancing

- ELB is a managed load balancer
	- Recommended to use
		- Upgrades are done automatically
		- Minimal configuration
		- Integrated with many other services
	- Performs health checks on instances
		- Usually 200 response from instance

# Types of Load Balancer

- Classic Load Balancer
	- deprecated
- Applicaiton Load Balancer
	- Web
	- Target group
	- Supports redirects
- Network Load Balancer
	- TCP, TLS, UDP
- Gateway Load Balancer
	- Layer 3

# Security

- Allow access on ports from anywhere
- Instances only allow from the load balancer (security group) on relevant port

# Application Load Balancer

- Usefule for micro services & container based applications
- Routing based off
	- Path
	- hostname
	- query string / headers
- Port mapping feature

![[AWS_ALB.png]]

# Target Groups

- route requests to one or more registered targets, such as EC2 instances, using the protocol and port number that you specify.
- Instance
- ECS tasks
- Lambda functions
- IP address
- Health check at traget group level

# Network Load Balancer

- Layer 4 (TCP & UDP traffic)
- High performance millions of requests and lower latency than ALB
- One static IP per AZ
	- Helpful for whitelisting
![[AWS_NLB.png]]


- NLB to ALB
	- Allows for static IP address
	- ALB allows rules for HTTP traffic

- Health Checks for NLB
	- TCP
	- HTTP
	- HTTPS

# Gateway Load Balancer

- All traffic of network through a firewall or DPS
	- Third part network virtual appliances
- Network level

![[AWS_GLB.png]]

- Transparent Netowrk Gateway
	- Single entry / exit
- Load Balancer
- GENEVE protocol 6081

# Sticky Sessions

- AKA Session Affinity
- Multiple requests from one client go to same instance
- Uses a cookie with expiration
	- **Application-based cookie**
		- Custom
			- Generated by target
			- Individual to target group
			- Not AWSALB, AWSALBAPP, AWSALBTG
		- Application cookie
			- Generated by load balancer
			- Name AWSALBAPP
	- **Duration-based cookie**
		- Generated by load balancer
		- AWSALB for ALB, AWSELB for CLB
- Makes sure not to lose session data

# Cross Zone Load Balancing

![[AWS_CZLB_With.png]]

- Both ALB load balancers spread load to  to all EC2 in all AZ

![[AWS_CZLB_Without.png]]

- Enabled by default on ALB
	- No charge for cross zone data here
- NLB & GLB disabled by default
	- Charges if enabled
- CLB
	- Disabled by default but no charge inter AZ

# Load Balancer Certificates

- In transit encryption from client to load balancer
- Using SSL / TLS
- Load balancer does SSL termination
- Certificates can be  managed with ACM (AWS Certificate Manager)

![[AWS_SSL_Termination.png]]

## SNI Server Name Indication

- Multiple SSL certificates onto one web server (to serve multiple websites)
- Requires client to indicate the hostname of the target server in the SSL handshake
- Only with ALB or NLB or cloudfront (Not CLB)

![[AWS_SNI.png]]

# Connection Draining

- Connection Draining for CLB
- Deregistration Delay for ALB / NLB

- Gives time to complete "in flight requests" while instance is de registering or unhealthy
- Stops sending new requests to instance
- Default 5 minutes
	- Choose time based on length of connection required