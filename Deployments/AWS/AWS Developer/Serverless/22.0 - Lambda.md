- Up to 10GB of RAM per function

# Integrations

- API Gateway
- Kinesis
- DynamoDB
- S3
- CloudFront
- CloudWatch Events EventBridge
- CloudWatch Logs
- SNS
- SQS
- Cognito

![[AWS_Lambda_Integrations.png]]

- User cases:
	- Thumbnail creation
		- S3 event trigger
		- Lambda function creates thumbnail and pushes to S3 bucket
		- Function also creates metadata and inserts into DynamoDB
	- Cron jobs

- Pricing
	- 1 000 000 requests free
	- 400 000 GB-seconds of compute free

# Synchronous Invocations

- Results are returned straight away
- Error handling must happen client side
	- Retires
	- Exponential back off
- Services:
	- User invoked
		- ELB / ALB
		- API gateway
		- CloudFront
		- S3 Batch
	- Service invoked
		- Amazon Cognito
		- AWS Step functions
	- Others
		- Amazon Lex
		- Amazon Alexa
		- Amazon Kinesis Data Firehose

# Lambda & ALB

- Lambda function must be in the [[7.1 - ELB#Target Groups|Target Group]] of the ALB

![[AWS_Lambda_ALB_Target_Group.png|500]]

- Converts HTTP request into JSON

- Request
	- ELB info
	- HTTP method & path
	- Query string params (key/value pairs)
	- Headers (key/value pairs)
	- Body (& isBase64Encoded)

![[AWS_Lambda_ALB_Request.png]]

- Response
	- Status code & description
	- Headers (key/value pairs)
	- Body (& isBase64Encoded)

## ALB Multi-Header Values

- Supported
	- Enabled in the target group attributes
- HTTP headers and query string parameters that have multiple values are shown as arrays in event and response objects

![[AWS_Lambda_ALB_Multi_Header.png|450]]

## ALB Lambda Permissions

- ALB needs permission to invoke the lambda function

![[AWS_Lambda_ALB_Permissions.png]]

# Lambda Asynchronous & DLQ

- Events are placed in an event queue
- Lambda will attempt 3 attempts
	- 1 min wait after first, 2 mins wait after second
- Processing should be idempotent
	- Same input leads to same output
- Retries will create duplicate logs in CloudWatch
- Can make a **DLQ** (Dead Letter Queue)
	- SQS or SNS for failed attempts
		- Requires IAM permissions
- Speed up processing allowing up to 1000 files to be processed

![[AWS_Lambda_Async.png]]

## Lambda Async Services

- Will return a 202 code if data has been received for processing
	- Not a code for the event being processed correctly

- S3 events
- SNS
- CloudWatch events / EventBridge
- AWS Commit
	- CodeCommit trigger (new branch, new tag, new push)
- AWS CodePipeline (Lambda must callback)
- CloudWatch logs ( processing)
- SES (Simple email service)
- CloudFormation
- AWS Config
- AWS IoT
- AWS IoT Events

# Lambda CloudWatch Events

- Cron job
- CodePipeline EventBridge Rule

![[AWS_Lambda_CloudWatch.png]]